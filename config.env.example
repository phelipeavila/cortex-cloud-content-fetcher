# =============================================================================
# Cortex Cloud Compliance Fetcher - Configuration
# =============================================================================
# Copy this file to config.env and fill in your values.
# DO NOT commit config.env to version control!

# -----------------------------------------------------------------------------
# API CREDENTIALS (Required)
# -----------------------------------------------------------------------------
# Your Cortex Cloud API URL (without trailing slash)
# Example: https://api-mycompany.xdr.us.paloaltonetworks.com
API_URL=https://api-YOUR_TENANT.xdr.us.paloaltonetworks.com

# API Key ID (x-xdr-auth-id header)
# Found in: Settings > Configurations > API Keys
API_ID=1

# API Key (Authorization header)
# The full API key string
API_KEY=YOUR_API_KEY_HERE

# -----------------------------------------------------------------------------
# HTTP COLLECTOR CREDENTIALS (Optional - for pushing data)
# -----------------------------------------------------------------------------
# These are used to push data to the HTTP Collector endpoint.
# The collector URL is auto-generated: https://api-{tenant}/logs/v1/event

# API Key for pushing COMPLIANCE ASSETS data
# Used by ComplianceFetchAssets
COMPLIANCE_API_KEY=

# API Key for pushing CONTROL SUMMARIES data
# Used by ComplianceCreateSummary
CONTROLS_API_KEY=

# -----------------------------------------------------------------------------
# ASSESSMENTS CONFIGURATION (Required)
# -----------------------------------------------------------------------------
# JSON array defining which standards and profiles to fetch.
# Format: [{"standard": "Standard Name", "profiles": ["Profile1", "Profile2"]}]
#
# Example with multiple standards:
# ASSESSMENTS=[{"standard": "CIS Azure Kubernetes Service (AKS) Benchmark v1.5", "profiles": ["CIS Azure Kubernetes Service (AKS) Benchmark v1.5"]}, {"standard": "CIS Critical Security Controls v8.1", "profiles": ["CIS Critical Security Controls v8.1"]}]
#
# Example with single standard:
ASSESSMENTS=[{"standard": "CIS Azure Kubernetes Service (AKS) Benchmark v1.5", "profiles": ["CIS Azure Kubernetes Service (AKS) Benchmark v1.5"]}]

# -----------------------------------------------------------------------------
# PROCESSING OPTIONS
# -----------------------------------------------------------------------------
# Page size for asset pagination (default: 100)
PAGE_SIZE=100

# Batch size for HTTP Collector push (default: 500)
BATCH_SIZE=500

# Maximum number of anchors to process (0 = all)
MAX_ANCHORS=0

# Number of parallel workers for API requests (default: 10)
# Used for both control fetching AND asset fetching
# Increase for faster fetching (up to 20), decrease if hitting rate limits
# With 1.5M assets @ 100/page = 15,107 pages
#   - 5 workers:  ~50 min
#   - 10 workers: ~25 min  
#   - 20 workers: ~12 min
PARALLEL_WORKERS=10

# Dry run mode - if true, won't push to HTTP Collector
DRY_RUN=true

# -----------------------------------------------------------------------------
# OUTPUT OPTIONS
# -----------------------------------------------------------------------------
# Directory for output files (default: ./output)
OUTPUT_DIR=./output
